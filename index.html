<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¿»è½‰æ•™è‚² è¡çªç®¡ç†é¢¨æ ¼æ¸¬é©—</title>
    <!-- å¼•å…¥ Google Fonts Noto Sans TC -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- å¼•å…¥ Chart.js å‡½å¼åº« -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- å¼•å…¥ html2canvas å‡½å¼åº« -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoVBL5gI9kLmbG4dGGBLezZg+VwbQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        :root {
            /* å“ç‰Œè¦–è¦ºè¦ç¯„ */
            --brand-primary: #004098; /* æ·±è—ï¼šæ¨™é¡Œã€ä¸»è¦æŒ‰éˆ• */
            --brand-accent: #00daee;  /* äº®è—ï¼šåœ–è¡¨ã€é€²åº¦æ¢ */
            
            /* æ¼¸å±¤è¨­å®š */
            --gradient-line: linear-gradient(90deg, #ffff00 0%, #00daee 100%); /* è£é£¾ç·š */
            --gradient-tag: linear-gradient(90deg, #1C2271 0%, #004098 100%);  /* æ¨™ç±¤åº•è‰² */
            
            /* èƒŒæ™¯èˆ‡æ–‡å­— */
            --background-color: #f0f7ff; /* æ¥µæ·ºè—åº•è‰²ï¼Œæ¸…çˆ½èˆ’é© */
            --card-background: #ffffff;
            --text-color: #333333;
            --light-text-color: #666666;
            --border-color: #e0e0e0;
            --shadow: 0 8px 24px rgba(0, 64, 152, 0.08); /* å¸¶ä¸€é»å“ç‰Œè‰²èª¿çš„é™°å½± */
        }

        html { scroll-behavior: smooth; }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 20px 1rem;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            color: var(--text-color);
            -webkit-font-smoothing: antialiased;
        }

        .tool-container {
            width: 100%;
            max-width: 520px;
        }

        .tool-card {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.5); /* å¾®å¼±é‚Šæ¡† */
            transition: opacity 0.5s ease, transform 0.5s ease;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden; /* ç¢ºä¿æ¼¸å±¤æ¢ä¸æº¢å‡ºåœ“è§’ */
        }

        /* é ‚éƒ¨æ¼¸å±¤è£é£¾æ¢ - ç¾ä»£æ„Ÿ */
        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gradient-line);
        }

        .hidden {
            display: none;
            opacity: 0;
        }
        .visible {
            display: block;
            opacity: 1;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h1, h2, h3 { color: var(--brand-primary); font-weight: 700; }
        
        h1 { 
            font-size: 1.8rem; 
            text-align: center; 
            margin: 0.5rem 0 0.5rem; 
            letter-spacing: 0.05em;
        }
        
        h2 { 
            font-size: 1.1rem; 
            text-align: center; 
            margin: 0 0 1.5rem; 
            color: var(--light-text-color);
            font-weight: 500;
        }
        
        h3 { font-size: 1.3rem; margin: 1.5rem 0 1rem; }

        /* åˆ†éš”ç·šæ¼¸å±¤è£é£¾ */
        .divider {
            height: 2px;
            background: var(--gradient-line);
            margin: 1.5rem auto;
            width: 60px;
            border-radius: 1px;
            opacity: 0.7;
        }

        p { line-height: 1.7; color: var(--light-text-color); margin-bottom: 1rem; }
        .text-center { text-align: center; }

        /* æŒ‰éˆ•å„ªåŒ– */
        button {
            font-family: 'Noto Sans TC', sans-serif;
            font-size: 1.05rem;
            font-weight: 700;
            border: none;
            border-radius: 50px; /* åœ“è§’æŒ‰éˆ•æ›´ç¾ä»£ */
            padding: 12px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            background-color: var(--brand-primary);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 64, 152, 0.2);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 64, 152, 0.3);
            background-color: #003380; /* æ·±ä¸€é»çš„ hover è‰² */
        }
        button:disabled {
            background-color: #e0e0e0;
            color: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* --- Quiz Screen --- */
        .progress-container {
            width: 100%;
            height: 6px;
            background-color: #edf2f7;
            border-radius: 3px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        #progress-indicator {
            width: 0%;
            height: 100%;
            background-color: var(--brand-accent); /* äº®è—è‰²é€²åº¦æ¢ */
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 8px rgba(0, 218, 238, 0.4); /* ç™¼å…‰æ•ˆæœ */
        }
        .question-meta {
            text-align: right;
            font-size: 0.9rem;
            color: var(--brand-primary);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .question-text {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            text-align: left;
            color: var(--text-color);
            line-height: 1.5;
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .option-label {
            display: flex;
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            align-items: flex-start; /* å°é½Šé–‹é ­ */
        }
        .option-label:hover {
            border-color: var(--brand-accent);
            background-color: #f8fdff;
            transform: translateX(4px);
        }
        .option-label input { display: none; }
        
        /* é¸ä¸­ç‹€æ…‹ */
        .option-label input:checked + span { 
            font-weight: 700; 
            color: var(--brand-primary); 
        }
        .option-label input:checked + span::before {
            border-color: var(--brand-accent);
            background-color: var(--brand-accent);
            box-shadow: 0 0 0 3px rgba(0, 218, 238, 0.2);
        }
        
        .option-label span {
            display: flex;
            align-items: flex-start;
            line-height: 1.6;
            width: 100%;
        }
        .option-label span::before {
            content: "";
            width: 18px;
            height: 18px;
            border: 2px solid #ccc;
            border-radius: 50%;
            margin-right: 12px;
            margin-top: 3px; /* å¾®èª¿å°é½Š */
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .quiz-nav { margin-top: 2rem; }

        /* --- Results Screen --- */
        #results-summary { text-align: center; margin-bottom: 2rem; }
        .result-style-name {
            font-size: 2.2rem;
            margin: 0.5rem 0;
            background: var(--gradient-tag);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }
        
        #chart-container { 
            margin: 2rem 0; 
            position: relative;
            padding: 10px;
        }

        /* é¢¨æ ¼è§£æå¡ç‰‡ (Accordion) */
        .accordion-item {
            border: 1px solid #edf2f7;
            border-radius: 12px;
            margin-bottom: 12px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .accordion-header {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            font-size: 1.05rem;
            color: white; /* æ–‡å­—åç™½ */
            background: var(--gradient-tag); /* æ¼¸å±¤æ¨™ç±¤åº•è‰² */
            transition: filter 0.3s ease;
        }
        .accordion-header:hover {
            filter: brightness(1.1);
        }
        .accordion-header::after {
            content: 'ï¼‹';
            font-size: 1.2rem;
            font-weight: 400;
            transition: transform 0.3s ease;
        }
        .accordion-item.active .accordion-header::after {
            transform: rotate(45deg);
        }
        .accordion-content {
            padding: 0 20px 20px;
            max-height: 0;
            overflow: hidden;
            background-color: #fff;
            transition: max-height 0.4s ease-out;
        }
        .accordion-content-inner {
            padding-top: 15px; /* ç”¨ inner div è™•ç† padding topï¼Œé¿å…å‹•ç•«è·³å‹• */
        }
        .accordion-content p { margin-bottom: 0.8rem; font-size: 0.95rem; }
        .accordion-content strong { color: var(--brand-primary); }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 2rem;
        }
        #download-btn { 
            background-color: var(--brand-primary);
            background-image: linear-gradient(135deg, var(--brand-primary) 0%, #0056b3 100%);
        }
        #restart-btn { 
            background-color: transparent; 
            border: 2px solid var(--border-color);
            color: var(--light-text-color);
            box-shadow: none;
        }
        #restart-btn:hover {
            background-color: #f8f9fa;
            border-color: var(--brand-primary);
            color: var(--brand-primary);
            transform: none;
        }

        /* Footer */
        .brand-footer {
            text-align: center; margin-top: 1rem; font-size: 0.9em; color: #adb5bd;
        }
        .brand-footer a { color: var(--brand-primary); text-decoration: none; font-weight: 500; }
        
        /* ä¸‹è¼‰æ™‚éš±è—çš„å…ƒç´  */
        .downloading .action-buttons, .downloading .brand-footer { display: none; }
        .downloading { padding: 40px; } /* å¢åŠ ä¸‹è¼‰åœ–ç‰‡çš„ç•™ç™½ */
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- Screen 1: Welcome -->
        <div id="welcome-screen" class="tool-card visible">
            <h1>æˆ‘çš„è¡çªç®¡ç†é¢¨æ ¼</h1>
            <h2>TKI æ¸¬é©—èˆ‡å€‹äººåŒ–å»ºè­°</h2>
            <div class="divider"></div>
            <div style="text-align:center; margin-bottom: 2rem;">
                <img src="https://img.icons8.com/color/96/collaboration.png" alt="Conflict Management" style="width: 80px; height: 80px; opacity: 0.9;">
            </div>
            <p class="text-center">é¢å°æ ¡åœ’ä¸­çš„å„ç¨®æºé€šæŒ‘æˆ°ï¼Œæ‚¨ç¿’æ…£å¦‚ä½•æ‡‰å°ï¼Ÿ<br>é€™ä¸æ˜¯è€ƒè©¦ï¼Œè€Œæ˜¯ä¸€æ¬¡è‡ªæˆ‘æ¢ç´¢çš„æ©Ÿæœƒã€‚</p>
            <p class="text-center" style="font-size: 0.9rem;">é€é 10 å€‹æƒ…å¢ƒé¡Œï¼Œæˆ‘å€‘å°‡æä¾›æ‚¨æº«æš–çš„å»ºè­°èˆ‡ç­–ç•¥ã€‚</p>
            <div style="margin-top: 2rem;">
                <button id="start-btn">é–‹å§‹æ¸¬é©—</button>
            </div>
        </div>

        <!-- Screen 2: Quiz -->
        <div id="quiz-screen" class="tool-card hidden">
            <div class="progress-container"><div id="progress-indicator"></div></div>
            <div class="question-meta" id="question-number"></div>
            <div id="question-text" class="question-text"></div>
            <div id="options-container" class="options-container"></div>
            <div class="quiz-nav">
                <button id="next-btn" disabled>ä¸‹ä¸€é¡Œ</button>
            </div>
        </div>

        <!-- Screen 3: Results -->
        <div id="results-screen" class="tool-card hidden">
            <!-- Wrapper for capture -->
            <div id="results-content-to-download">
                <h1>æ¸¬é©—çµæœåˆ†æ</h1>
                <div class="divider"></div>
                <div id="results-summary"></div>
                
                <div id="chart-container">
                    <canvas id="results-chart"></canvas>
                </div>
                
                <h3 style="text-align: center; margin-bottom: 1rem;">å„é¢¨æ ¼æ·±åº¦è§£æ</h3>
                <p style="text-align: center; font-size: 0.9rem; margin-bottom: 1.5rem;">é»æ“Šä¸‹æ–¹æ¨™ç±¤å±•é–‹å»ºè­°</p>
                <div id="accordion-container"></div>
            </div>
            
            <div class="action-buttons">
                <button id="download-btn">ä¸‹è¼‰æˆ‘çš„é¢¨æ ¼åˆ†æåœ–</button>
                <button id="restart-btn">é‡æ–°æ¸¬é©—</button>
            </div>
        </div>

        <footer class="brand-footer">
            <p>ç”± <a href="https://flipedu.parenting.com.tw/" target="_blank" rel="noopener noreferrer">ç¿»è½‰æ•™è‚²</a> æº«æš–æä¾›</p>
        </footer>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- å…ƒç´ å®£å‘Š ---
        const screens = {
            welcome: document.getElementById('welcome-screen'),
            quiz: document.getElementById('quiz-screen'),
            results: document.getElementById('results-screen')
        };
        const buttons = {
            start: document.getElementById('start-btn'),
            next: document.getElementById('next-btn'),
            download: document.getElementById('download-btn'),
            restart: document.getElementById('restart-btn')
        };
        const quizElements = {
            progress: document.getElementById('progress-indicator'),
            qNumber: document.getElementById('question-number'),
            qText: document.getElementById('question-text'),
            options: document.getElementById('options-container')
        };
        const resultsElements = {
            summary: document.getElementById('results-summary'),
            chartCanvas: document.getElementById('results-chart'),
            accordion: document.getElementById('accordion-container'),
            downloadArea: document.getElementById('results-content-to-download')
        };
        let myChart;

        // --- è³‡æ–™åº« ---
        const styles = {
            competing: 'ç«¶çˆ­å‹',
            collaborating: 'åˆä½œå‹',
            compromising: 'å¦¥å”å‹',
            avoiding: 'è¿´é¿å‹',
            accommodating: 'é©æ‡‰å‹'
        };

        const questions = [
            {
                text: "ç•¶ä¸€ä½å®¶é•·åœ¨è¯çµ¡ç°¿ä¸Šï¼Œå¼·çƒˆè³ªç–‘æ‚¨çš„è©•åˆ†æ¨™æº–æ™‚ï¼Œæ‚¨å‚¾å‘...",
                options: [
                    { text: "å …æŒè‡ªå·±çš„å°ˆæ¥­åˆ¤æ–·ï¼Œä¸¦å‘å®¶é•·æ¸…æ¥šèªªæ˜è©•åˆ†æ¨™æº–çš„å…¬æ­£æ€§ã€‚", style: "competing" },
                    { text: "é‚€è«‹å®¶é•·åˆ°æ ¡è©³è«‡ï¼Œä¸€èµ·æ‰¾å‡ºå°å­©å­å­¸ç¿’æœ€æœ‰å¹«åŠ©çš„æ–¹å¼ï¼Œä¸¦é¡˜æ„èª¿æ•´ä½œæ³•ã€‚", style: "collaborating" },
                    { text: "åŒæ„åœ¨é€™æ¬¡çš„æˆç¸¾ä¸Šåšäº›å¾®èª¿æ•´ï¼Œä»¥å®‰æ’«å®¶é•·ï¼Œä½†ä¸‹æ¬¡æœƒå°‡è¦å‰‡èªªå¾—æ›´æ¸…æ¥šã€‚", style: "compromising" },
                    { text: "å…ˆä¸ç›´æ¥å›æ‡‰è³ªç–‘ï¼Œæ‰¾æ™‚é–“èˆ‡å…¶ä»–åŒäº‹è¨è«–ï¼Œçœ‹çœ‹å¤§å®¶é€šå¸¸å¦‚ä½•è™•ç†ã€‚", style: "avoiding" },
                    { text: "ç†è§£å®¶é•·æ„›å­å¿ƒåˆ‡ï¼Œå„ªå…ˆå®‰æ’«å®¶é•·æƒ…ç·’ï¼Œè¡¨ç¤ºæœƒé‡æ–°å¯©è¦–å­©å­çš„è€ƒå·ã€‚", style: "accommodating" }
                ]
            },
            {
                text: "ç­ä¸Šå…©ä½å­¸ç”Ÿç‚ºäº†æ‰“æƒå·¥ä½œåˆ†é…ä¸å‡è€Œåµæ¶ï¼Œæ‚¨ä»‹å…¥æ™‚æœƒ...",
                options: [
                    { text: "ç›´æ¥åšå‡ºè£æ±ºï¼Œæ˜ç¢ºåŠƒåˆ†å…©äººçš„å·¥ä½œç¯„åœï¼Œè¦æ±‚é›™æ–¹éµå®ˆã€‚", style: "competing" },
                    { text: "èŠ±æ™‚é–“èˆ‡å…©ä½å­¸ç”Ÿå°è«‡ï¼Œå¼•å°ä»–å€‘èªªå‡ºå„è‡ªçš„æƒ³æ³•ï¼Œå…±åŒæ‰¾å‡ºä¸€å€‹å…©äººéƒ½æ»¿æ„çš„åˆ†é…æ–¹å¼ã€‚", style: "collaborating" },
                    { text: "å»ºè­°å…©äººå„é€€ä¸€æ­¥ï¼Œé€™æ¬¡çš„å·¥ä½œä¸€äººä¸€åŠï¼Œä¸‹æ¬¡å†æ›ã€‚", style: "compromising" },
                    { text: "å‘Šè¨´ä»–å€‘å…ˆå†·éœä¸€ä¸‹ï¼Œé€™ä¸æ˜¯ä»€éº¼å¤§äº‹ï¼Œç­‰æƒ…ç·’å¥½äº†å†èªªã€‚", style: "avoiding" },
                    { text: "å…ˆå®‰æ’«æƒ…ç·’è¼ƒæ¿€å‹•çš„ä¸€æ–¹ï¼Œç­”æ‡‰æœƒå¹«ä»–å¤šåˆ†æ“”ä¸€äº›å·¥ä½œï¼Œè®“äº‹æƒ…ç›¡å¿«å¹³æ¯ã€‚", style: "accommodating" }
                ]
            },
            {
                text: "åœ¨ç§‘ä»»æœƒè­°ä¸Šï¼Œæ‚¨å’Œä¸€ä½è³‡æ·±åŒäº‹å°æ–¼æ•™å­¸é€²åº¦çš„çœ‹æ³•ä¸åŒï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "æ“šç†åŠ›çˆ­ï¼Œæå‡ºæ•¸æ“šå’Œæ¡ˆä¾‹ä¾†è­‰æ˜è‡ªå·±çš„æ–¹æ¡ˆæ›´æœ‰æ•ˆç‡ã€‚", style: "competing" },
                    { text: "æè­°å°‡å…©ç¨®æ–¹æ¡ˆçš„å„ªé»çµåˆï¼Œå‰µé€ ä¸€å€‹å…¨æ–°çš„ã€å°é›™æ–¹éƒ½æœ‰åˆ©çš„æ•™å­¸è¨ˆç•«ã€‚", style: "collaborating" },
                    { text: "æå‡ºæŠ˜è¡·æ–¹æ¡ˆï¼Œä¾‹å¦‚ã€Œä¸ŠåŠå­¸æœŸç…§æ‚¨çš„é€²åº¦ï¼Œä¸‹åŠå­¸æœŸè©¦è©¦æˆ‘çš„æ–¹å¼ã€ã€‚", style: "compromising" },
                    { text: "èªç‚ºå’Œè«§æ¯”çˆ­åŸ·é‡è¦ï¼Œæš«æ™‚ä¸å …æŒå·±è¦‹ï¼Œè®“æœƒè­°é †åˆ©é€²è¡Œä¸‹å»ã€‚", style: "avoiding" },
                    { text: "å°Šé‡å‰è¼©çš„ç¶“é©—ï¼Œé¸æ“‡æ”¯æŒåŒäº‹çš„çœ‹æ³•ï¼Œä¸¦è¡¨ç¤ºé¡˜æ„å…¨åŠ›é…åˆã€‚", style: "accommodating" }
                ]
            },
            {
                text: "æ ¡æ…¶æ´»å‹•åˆ†å·¥ç¹é‡ï¼Œæœ‰ä½åŒäº‹æ˜é¡¯åœ¨æ¨å¸è²¬ä»»ï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "ç›´æ¥æ‰¾é‚£ä½åŒäº‹æºé€šï¼Œæ˜ç¢ºæŒ‡å‡ºä»–éœ€è¦å®Œæˆçš„éƒ¨åˆ†ï¼Œè¦æ±‚ä»–è² èµ·è²¬ä»»ã€‚", style: "competing" },
                    { text: "æ‰¾é‚£ä½åŒäº‹å’Œå…¶ä»–çµ„å“¡ä¸€èµ·é–‹æœƒï¼Œé‡æ–°è¨è«–å¤§å®¶éƒ½èƒ½æ¥å—ä¸”å…¬å¹³çš„åˆ†å·¥æ–¹å¼ã€‚", style: "collaborating" },
                    { text: "è‡ªå·±å¤šåšä¸€é»ï¼Œä½†ä¹Ÿè·Ÿå°æ–¹å”å•†ï¼Œè«‹ä»–è‡³å°‘å¹«å¿™å®Œæˆå…¶ä¸­æœ€ç°¡å–®çš„éƒ¨åˆ†ã€‚", style: "compromising" },
                    { text: "è¦ºå¾—ä¸æƒ³ç‚ºäº†é€™ä»¶äº‹å‚·å’Œæ°£ï¼Œè‡ªå·±é»˜é»˜æŠŠäº‹æƒ…åšå®Œå°±ç®—äº†ã€‚", style: "avoiding" },
                    { text: "æ“”å¿ƒå°æ–¹æœ‰é›£è™•ï¼Œä¸»å‹•è¡¨ç¤ºé¡˜æ„å¹«ä»–åˆ†æ“”ï¼Œå¸Œæœ›åœ˜éšŠæ´»å‹•èƒ½é †åˆ©ã€‚", style: "accommodating" }
                ]
            },
            {
                text: "å­¸æ ¡æ¨å‹•ä¸€é …æ–°çš„è¡Œæ”¿è¦æ±‚ï¼Œæ‚¨èªç‚ºä¸åˆç†ä¸”æœƒå¢åŠ è² æ“”ï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "åœ¨æœƒè­°ä¸Šå…¬é–‹æå‡ºåå°æ„è¦‹ï¼Œä¸¦é—¡è¿°é€™é …è¦æ±‚å¯èƒ½å¸¶ä¾†çš„è² é¢å½±éŸ¿ã€‚", style: "competing" },
                    { text: "èˆ‡å…¶ä»–åŒäº‹è¨è«–ï¼Œå…±åŒè‰æ“¬ä¸€ä»½æ›¿ä»£æ–¹æ¡ˆï¼Œå‘è¡Œæ”¿å–®ä½æå‡ºï¼Œå°‹æ±‚é›™è´ã€‚", style: "collaborating" },
                    { text: "å…ˆè©¦è‘—åšä¸€éƒ¨åˆ†ï¼Œå†è·Ÿä¸»ç®¡åæ˜ åŸ·è¡Œä¸Šçš„å›°é›£ï¼Œå¸Œæœ›èƒ½æ¸›å°‘ä¸€äº›å·¥ä½œé‡ã€‚", style: "compromising" },
                    { text: "å…ˆè§€æœ›ä¸€ä¸‹ï¼Œçœ‹çœ‹å…¶ä»–äººçš„åæ‡‰ï¼Œæš«æ™‚ä¸æ¡å–ä»»ä½•è¡Œå‹•ã€‚", style: "avoiding" },
                    { text: "é›–ç„¶è¦ºå¾—ä¸åˆç†ï¼Œä½†æ—¢ç„¶æ˜¯è¦å®šï¼Œå°±é‚„æ˜¯ç›¡åŠ›é…åˆå®Œæˆã€‚", style: "accommodating" }
                ]
            },
            {
                text: "æœ‰å­¸ç”Ÿä¸Šèª²å±¢æ¬¡æ•…æ„æ—äº‚ï¼Œå½±éŸ¿èª²å ‚ç§©åºï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "ç«‹å³åˆ¶æ­¢ï¼Œä¸¦åš´æ ¼åŸ·è¡Œç­è¦ï¼Œçµ¦äºˆæ˜ç¢ºçš„æ‡²è™•ï¼Œä»¥å„†æ•ˆå°¤ã€‚", style: "competing" },
                    { text: "èª²å¾Œæ‰¾å­¸ç”Ÿæ·±è«‡ï¼Œè©¦åœ–ç†è§£ä»–è¡Œç‚ºèƒŒå¾Œçš„åŸå› ï¼Œä¸¦è·Ÿä»–ä¸€èµ·æƒ³è¾¦æ³•è§£æ±ºä»–çš„å›°æ“¾ã€‚", style: "collaborating" },
                    { text: "è·Ÿå­¸ç”Ÿç´„å®šï¼Œå¦‚æœä»–æœ‰å¹¾å ‚èª²èƒ½ä¿æŒå®‰éœï¼Œå°±çµ¦äºˆçå‹µä½œç‚ºäº¤æ›ã€‚", style: "compromising" },
                    { text: "æœ‰æ™‚å€™é¸æ“‡æš«æ™‚å¿½ç•¥ä»–çš„å°å‹•ä½œï¼Œåªè¦ä¸å½±éŸ¿åˆ°ä¸»è¦æ•™å­¸æµç¨‹å°±å¥½ã€‚", style: "avoiding" },
                    { text: "è©¦è‘—èª¿æ•´è‡ªå·±çš„ä¸Šèª²æ–¹å¼ï¼Œå¢åŠ æ›´å¤šæœ‰è¶£çš„æ´»å‹•ï¼Œå¸Œæœ›èƒ½å¸å¼•ä»–çš„æ³¨æ„åŠ›ã€‚", style: "accommodating" }
                ]
            },
            {
                text: "å®¶é•·å°æ‚¨è¦åŠƒçš„æˆ¶å¤–æ•™å­¸åœ°é»æœ‰ç–‘æ…®ï¼Œèªç‚ºä¸å¤ å®‰å…¨ï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "æ‹¿å‡ºå®Œæ•´çš„å®‰å…¨è©•ä¼°å ±å‘Šï¼Œå¼·èª¿è‡ªå·±çš„å°ˆæ¥­è¦åŠƒï¼Œè«‹å®¶é•·ç›¸ä¿¡å­¸æ ¡çš„å®‰æ’ã€‚", style: "competing" },
                    { text: "æ„Ÿè¬å®¶é•·çš„æé†’ï¼Œä¸¦é‚€è«‹ä»–åŠ å…¥ç±Œå‚™å°çµ„ï¼Œä¸€èµ·å‹˜æŸ¥å ´åœ°ï¼Œå®Œå–„å®‰å…¨è¨ˆç•«ã€‚", style: "collaborating" },
                    { text: "ç‚ºäº†è®“å¤§å¤šæ•¸å®¶é•·æ”¾å¿ƒï¼Œæ›´æ›åˆ°ä¸€å€‹å¤§å®¶æ™®éèªç‚ºæ›´å®‰å…¨çš„å‚™æ¡ˆåœ°é»ã€‚", style: "compromising" },
                    { text: "åœ¨LINEç¾¤çµ„ä¸­çœ‹åˆ°è¨Šæ¯ï¼Œä½†æƒ³èªªç­‰æœ‰æ›´å¤šäººé™„å’Œæ™‚å†ä¸€èµ·å›è¦†ã€‚", style: "avoiding" },
                    { text: "ç«‹åˆ»å‘å®¶é•·è¡¨ç¤ºï¼Œæ—¢ç„¶ä»–æœ‰ç–‘æ…®ï¼Œå­¸æ ¡æœƒå„ªå…ˆè€ƒæ…®ä»–çš„å»ºè­°ï¼Œä¸¦é‡æ–°å°‹æ‰¾åœ°é»ã€‚", style: "accommodating" }
                ]
            },
            {
                text: "æ‚¨éœ€è¦å‘å­¸æ ¡ç”³è«‹ä¸€ç­†ç¶“è²»ä¾†å……å¯¦ç­ç´šåœ–æ›¸ï¼Œä½†ç¶“è²»æœ‰é™ï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "ç›¡åŠ›é™³è¿°ç­ç´šé–±è®€çš„é‡è¦æ€§ï¼Œä¸¦èˆ‡å…¶ä»–ææ¡ˆè€…ç«¶çˆ­ï¼ŒåŠ›æ±‚çˆ­å–åˆ°å…¨é¡ç¶“è²»ã€‚", style: "competing" },
                    { text: "èˆ‡å…¶ä»–ä¹Ÿæœ‰éœ€æ±‚çš„è€å¸«åˆä½œï¼Œæå‡ºä¸€å€‹å¯ä»¥è³‡æºå…±äº«çš„åœ–æ›¸è¨ˆç•«ï¼Œè®“ç¸½æ•ˆç›Šæœ€å¤§åŒ–ã€‚", style: "collaborating" },
                    { text: "ä¸»å‹•å‰Šæ¸›ä¸€äº›æ¬¡è¦çš„æ›¸å–®ï¼Œæå‡ºä¸€å€‹è¼ƒä½çš„ç¶“è²»éœ€æ±‚ï¼Œä»¥æé«˜éå¯©çš„æ©Ÿæœƒã€‚", style: "compromising" },
                    { text: "è½åˆ°ç¶“è²»å¾ˆå°‘ï¼Œè¦ºå¾—ç”³è«‹éç¨‹å¤ªéº»ç…©ï¼Œå¯èƒ½å°±å…ˆæš«ç·©é€™å€‹è¨ˆç•«ã€‚", style: "avoiding" },
                    { text: "çœ‹åˆ°å…¶ä»–è€å¸«æ¯”æ‚¨æ›´éœ€è¦é€™ç­†éŒ¢ï¼Œä¸»å‹•é€€å‡ºç”³è«‹ï¼ŒæŠŠæ©Ÿæœƒè®“çµ¦åˆ¥äººã€‚", style: "accommodating" }
                ]
            },
            {
                text: "ä¸€ä½åŒäº‹ç¶“å¸¸å‘æ‚¨æŠ±æ€¨å·¥ä½œï¼Œä½”ç”¨æ‚¨è¨±å¤šå‚™èª²æ™‚é–“ï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "ç›´æ¥å‘Šè¨´ä»–ï¼šã€Œä¸å¥½æ„æ€ï¼Œæˆ‘ç¾åœ¨éœ€è¦å°ˆå¿ƒå‚™èª²ï¼Œå¯èƒ½æ²’è¾¦æ³•èŠé€™éº¼ä¹…ã€‚ã€", style: "competing" },
                    { text: "åŒç†ä»–çš„è¾›è‹¦ï¼Œä¸¦æè­°ï¼šã€Œä¸å¦‚æˆ‘å€‘ç´„å€‹åˆä¼‘æ™‚é–“ï¼Œæ³¡æ¯å’–å•¡å¥½å¥½èŠèŠï¼Ÿã€", style: "collaborating" },
                    { text: "è½ä»–èªªä¸€æœƒå…’ï¼Œç„¶å¾Œæ‰¾å€‹è—‰å£ï¼Œä¾‹å¦‚ã€Œæˆ‘å¾—å…ˆå»å°å€‹è¬›ç¾©ã€ï¼Œä¾†ç¸®çŸ­è«‡è©±ã€‚", style: "compromising" },
                    { text: "çœ‹åˆ°ä»–èµ°éä¾†ï¼Œå°±å‡è£å¾ˆå¿™ï¼Œæˆ´ä¸Šè€³æ©Ÿï¼Œå¸Œæœ›ä»–ä¸è¦ä¾†æ‰¾ä½ ã€‚", style: "avoiding" },
                    { text: "è¦ºå¾—åŒäº‹éœ€è¦æ”¯æŒï¼Œæ”¾ä¸‹æ‰‹é‚Šå·¥ä½œï¼Œå°ˆå¿ƒè½ä»–å‚¾è¨´ï¼Œå³ä½¿è‡ªå·±çš„äº‹æœƒå»¶å¾Œã€‚", style: "accommodating" }
                ]
            },
            {
                text: "å°æ–¼æ ¡æ…¶ä½ˆç½®é¢¨æ ¼ï¼Œæ‚¨å’Œå…¶ä»–è€å¸«çš„æ„è¦‹ç›¸å·¦ï¼Œæ‚¨æœƒ...",
                options: [
                    { text: "å …æŒè‡ªå·±çš„ç¾å­¸å’Œæ•™è‚²ç†å¿µï¼Œä¸¦åŠªåŠ›èªªæœå°æ–¹æ¥å—æ‚¨çš„æ–¹æ¡ˆã€‚", style: "competing" },
                    { text: "æè­°ä¸€èµ·ä¸Šç¶²æ‰¾è³‡æ–™ï¼Œèåˆé›™æ–¹çš„æƒ³æ³•ï¼Œå‰µé€ å‡ºä¸€å€‹ç¨ä¸€ç„¡äºŒçš„å…¨æ–°é¢¨æ ¼ã€‚", style: "collaborating" },
                    { text: "å»ºè­°ä¸åŒå€åŸŸå„è‡ªè² è²¬è‡ªå·±çš„å€åŸŸï¼Œä½ˆç½®æˆè‡ªå·±å–œæ­¡çš„æ¨£å­ã€‚", style: "compromising" },
                    { text: "è¦ºå¾—é€™ä¸æ˜¯æœ€é‡è¦çš„äº‹ï¼Œä¸æƒ³å› æ­¤å‚·äº†å’Œæ°£ï¼Œå°±å…ˆä¸è¨è«–é€™å€‹è©±é¡Œã€‚", style: "avoiding" },
                    { text: "èªç‚ºå’Œè«§æœ€é‡è¦ï¼Œå› æ­¤ä¸»å‹•é€€è®“ï¼Œè¡¨ç¤ºå®Œå…¨å°Šé‡æ­ç­è€å¸«çš„æƒ³æ³•ã€‚", style: "accommodating" }
                ]
            }
        ];

        const styleInfo = {
            competing: { 
                name: 'ç«¶çˆ­å‹ (è²“é ­é·¹)',
                icon: 'ğŸ¦‰',
                desc: 'é‡è¦–å€‹äººç›®æ¨™çš„é”æˆï¼Œæœæ–·ä¸”ä¸ç•æ‡¼å°æŠ—ï¼Œåƒè²“é ­é·¹ä¸€æ¨£ç²¾æº–åœ°æœç›®æ¨™å‰é€²ã€‚',
                strength: 'åœ¨éœ€è¦å¿«é€Ÿæ±ºç­–ã€åŸ·è¡Œé‡è¦åŸå‰‡æˆ–ä¿è­·å­¸ç”Ÿæ¬Šç›Šæ™‚ï¼Œé€™ç¨®é¢¨æ ¼éå¸¸æœ‰æ•ˆç‡ï¼Œèƒ½è¿…é€Ÿç©©å®šå±€é¢ã€‚',
                blindspot: 'åœ¨äººéš›é—œä¿‚ä¸­ï¼Œå¯èƒ½æœƒå› ç‚ºéæ–¼å …æŒå·±è¦‹ï¼Œè€Œå¿½ç•¥ä»–äººæ„Ÿå—ï¼Œè®“å°æ–¹æ„Ÿåˆ°å£“åŠ›æˆ–ä¸è¢«å°Šé‡ã€‚',
                suggestion: 'å»ºè­°åœ¨å …æŒåŸå‰‡çš„åŒæ™‚ï¼Œå¯ä»¥è©¦è‘—åŠ å…¥æ›´å¤šã€Œæˆ‘è¨Šæ¯ã€çš„è¡¨é”ï¼Œä¸¦çµ¦äºˆå°æ–¹è¡¨é”çš„ç©ºé–“ï¼Œè®“æ±ºç­–æ›´æœ‰æº«åº¦ã€‚'
            },
            collaborating: { 
                name: 'åˆä½œå‹ (æµ·è±š)', 
                icon: 'ğŸ¬',
                desc: 'åŒæ™‚é‡è¦–ç›®æ¨™èˆ‡é—œä¿‚ï¼Œè‡´åŠ›æ–¼å°‹æ‰¾é›™è´çš„å‰µæ„è§£æ–¹ï¼Œå¦‚åŒè°æ˜åˆä½œçš„æµ·è±šï¼Œå…±å‰µæœ€å¤§æ•ˆç›Šã€‚',
                strength: 'èƒ½æœ‰æ•ˆè™•ç†è¤‡é›œå•é¡Œï¼Œæ·±åŒ–è¦ªå¸«ç”Ÿé–“çš„ä¿¡ä»»æ„Ÿã€‚é€éæ•´åˆå¤šæ–¹è§€é»ï¼Œèƒ½ç”¢å‡ºæœ€æœ‰å“è³ªçš„æ±ºç­–ã€‚',
                blindspot: 'è€—æ™‚è€—åŠ›ï¼Œä¸¦éæ‰€æœ‰è¡çªéƒ½å€¼å¾—æŠ•å…¥å¦‚æ­¤é«˜çš„å¿ƒåŠ›ã€‚æœ‰æ™‚åœ¨å°äº‹ä¸Šéåº¦è¿½æ±‚å®Œç¾åˆä½œï¼Œåè€Œæœƒé™ä½æ•ˆç‡ã€‚',
                suggestion: 'å»ºè­°å­¸ç¿’åˆ¤æ–·è­°é¡Œçš„é‡è¦æ€§ã€‚å°‡å¯¶è²´çš„åˆä½œå¿ƒåŠ›ç”¨åœ¨é—œéµçš„ã€é•·æœŸçš„è­°é¡Œä¸Šã€‚åœ¨è¼ƒç·Šæ€¥æˆ–æ¬¡è¦çš„å•é¡Œä¸Šï¼Œå¯åƒè€ƒå…¶ä»–æ¨¡å¼ã€‚'
            },
            compromising: { 
                name: 'å¦¥å”å‹ (ç‹ç‹¸)', 
                icon: 'ğŸ¦Š',
                desc: 'é¡˜æ„å„é€€ä¸€æ­¥ï¼Œå°‹æ±‚å¿«é€Ÿä¸”é›™æ–¹éƒ½èƒ½æ¥å—çš„æŠ˜è¡·æ–¹æ¡ˆï¼Œåƒç‹ç‹¸ä¸€æ¨£å‹™å¯¦ä¸”éˆæ´»ã€‚',
                strength: 'è™•ç†ä¸­åº¦é‡è¦çš„è­°é¡Œæ™‚éå¸¸æœ‰æ•ˆç‡ï¼Œèƒ½å¿«é€Ÿè§£æ±ºåƒµå±€ï¼Œè®“äº‹æƒ…ç¹¼çºŒå‰é€²ï¼Œæ˜¯ç¶­æŒåœ˜éšŠé‹ä½œçš„æ½¤æ»‘åŠ‘ã€‚',
                blindspot: 'æœ‰æ™‚å¦¥å”çš„çµæœä¸¦éã€Œæœ€å¥½ã€çš„æ–¹æ¡ˆï¼Œåªæ˜¯ã€Œæœ€ä¸å·®ã€çš„ã€‚é•·æœŸä¸‹ä¾†ï¼Œå¯èƒ½å°è‡´é›™æ–¹éƒ½æ²’æœ‰çœŸæ­£æ»¿æ„ã€‚',
                suggestion: 'åœ¨å°‹æ±‚å¦¥å”æ™‚ï¼Œä¸å¦¨å¤šå•ä¸€å¥ï¼šã€Œé€™å€‹æ–¹æ¡ˆï¼Œæˆ‘å€‘é›™æ–¹çœŸçš„éƒ½èƒ½æ¥å—å—ï¼Ÿæˆ–åªæ˜¯æš«æ™‚æ‡‰ä»˜ï¼Ÿã€ç¢ºä¿å¦¥å”çš„å“è³ªã€‚'
            },
            avoiding: { 
                name: 'è¿´é¿å‹ (çƒé¾œ)', 
                icon: 'ğŸ¢',
                desc: 'é¸æ“‡æš«æ™‚ä¸è™•ç†è¡çªï¼Œå°‡è‡ªå·±ç¸®é€²æ®¼è£¡ï¼Œä»¥é™ä½ç·Šå¼µé—œä¿‚æˆ–çˆ­å–æ€è€ƒæ™‚é–“ã€‚',
                strength: 'é¢å°ç„¡é—œç·Šè¦çš„å°äº‹ï¼Œæˆ–åœ¨æƒ…ç·’é«˜åº¦ç·Šå¼µçš„ç•¶ä¸‹ï¼Œæš«æ™‚è¿´é¿æ˜¯å†·å»å±€å‹¢çš„æ™ºæ…§ï¼Œèƒ½é¿å…èªªå‡ºå¾Œæ‚”çš„è©±ã€‚',
                blindspot: 'è‹¥é•·æœŸè¿´é¿é‡è¦å•é¡Œï¼Œå•é¡Œä¸åƒ…ä¸æœƒæ¶ˆå¤±ï¼Œé‚„å¯èƒ½æƒ¡åŒ–ï¼Œä¸¦å¯èƒ½è®“ä»–äººè¦ºå¾—æ‚¨ä¸åœ¨ä¹æˆ–ç¼ºä¹æ“”ç•¶ã€‚',
                suggestion: 'å»ºè­°å€åˆ†ã€Œç­–ç•¥æ€§è¿´é¿ã€èˆ‡ã€Œç¿’æ…£æ€§é€ƒé¿ã€ã€‚è‹¥é¸æ“‡è¿´é¿ï¼Œå¯ä»¥å‘Šè¨´è‡ªå·±ï¼šã€Œæˆ‘åªæ˜¯ã€ç¾åœ¨ã€ä¸è™•ç†ï¼Œç­‰æˆ‘æº–å‚™å¥½ï¼Œæˆ‘æœƒå›é ­é¢å°å®ƒã€‚ã€'
            },
            accommodating: { 
                name: 'é©æ‡‰å‹ (æ³°è¿ªç†Š)', 
                icon: 'ğŸ§¸',
                desc: 'å„ªå…ˆè€ƒæ…®å°æ–¹éœ€æ±‚èˆ‡é—œä¿‚å’Œè«§ï¼Œé¡˜æ„çŠ§ç‰²è‡ªå·±çš„ç›®æ¨™ï¼Œåƒæº«æš–çš„æ³°è¿ªç†Šä¸€æ¨£ï¼Œçµ¦äºˆæ”¯æŒèˆ‡å®‰æ’«ã€‚',
                strength: 'ç•¶è­°é¡Œå°å°æ–¹é æ¯”å°è‡ªå·±é‡è¦æ™‚ï¼Œæˆ–ç•¶æ‚¨éœ€è¦ç‚ºé—œä¿‚ã€Œå„²å€¼ã€æ™‚ï¼Œé€™æ˜¯ä¸€ç¨®ç¶­æŒå’Œè«§çš„å¤§åº¦è¡¨ç¾ã€‚',
                blindspot: 'é•·æœŸå¿½ç•¥è‡ªèº«éœ€æ±‚ï¼Œå¯èƒ½æœƒæ„Ÿåˆ°å§”å±ˆæˆ–è¢«åˆ©ç”¨ã€‚æ‚¨çš„å–„æ„ä¹Ÿå¯èƒ½è¢«è¦–ç‚ºç†æ‰€ç•¶ç„¶ã€‚',
                suggestion: 'åœ¨é€€è®“çš„åŒæ™‚ï¼Œå»ºè­°æ‚¨æº«å’Œåœ°è¡¨é”è‡ªå·±çš„æ„Ÿå—èˆ‡åº•ç·šã€‚ä¾‹å¦‚ï¼šã€Œé€™æ¬¡æˆ‘å¯ä»¥é…åˆä½ ï¼Œä½†ä¹Ÿå¸Œæœ›ä¸‹æ¬¡èƒ½è½è½æˆ‘çš„æƒ³æ³•ã€‚ã€'
            }
        };


        let currentQuestionIndex = 0;
        let scores = { competing: 0, collaborating: 0, compromising: 0, avoiding: 0, accommodating: 0 };

        // --- Functions ---
        function switchScreen(hide, show) {
            hide.classList.remove('visible');
            hide.classList.add('hidden');
            setTimeout(() => {
                show.classList.remove('hidden');
                show.classList.add('visible');
                window.scrollTo(0, 0);
            }, 300);
        }

        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showResults();
                return;
            }
            const q = questions[currentQuestionIndex];
            quizElements.progress.style.width = `${(currentQuestionIndex / questions.length) * 100}%`;
            quizElements.qNumber.textContent = `Q${currentQuestionIndex + 1}`;
            quizElements.qText.textContent = q.text;
            quizElements.options.innerHTML = '';

            q.options.forEach(option => {
                const label = document.createElement('label');
                label.className = 'option-label';
                label.innerHTML = `
                    <input type="radio" name="option" value="${option.style}">
                    <span>${option.text}</span>
                `;
                quizElements.options.appendChild(label);
            });
            
            document.querySelectorAll('input[name="option"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    buttons.next.disabled = false;
                });
            });
            
            buttons.next.disabled = true;
            if(currentQuestionIndex === questions.length - 1) {
                buttons.next.textContent = 'å®Œæˆæ¸¬é©—ï¼ŒæŸ¥çœ‹çµæœ';
            } else {
                buttons.next.textContent = 'ä¸‹ä¸€é¡Œ';
            }
        }

        function showResults() {
            quizElements.progress.style.width = '100%';
            
            const sortedScores = Object.entries(scores).sort(([,a],[,b]) => b-a);
            const primaryStyle = sortedScores[0][0];
            const secondaryStyle = sortedScores[1][0];

            resultsElements.summary.innerHTML = `
                <p>æ ¹æ“šæ‚¨çš„å›ç­”ï¼Œæ‚¨çš„ä¸»è¦è¡çªç®¡ç†é¢¨æ ¼æ˜¯</p>
                <h2 class="result-style-name">${styleInfo[primaryStyle].icon} ${styleInfo[primaryStyle].name}</h2>
                <p>é€™ä»£è¡¨åœ¨é¢å°è¡çªæ™‚ï¼Œæ‚¨å‚¾å‘é‹ç”¨ã€Œ${styles[primaryStyle]}ã€ç­–ç•¥ã€‚<br>
                å…¶æ¬¡æ˜¯ <strong>${styleInfo[secondaryStyle].name}</strong> é¢¨æ ¼ã€‚</p>
            `;

            renderChart();
            buildAccordion();
            switchScreen(screens.quiz, screens.results);
        }

        function renderChart() {
            const ctx = resultsElements.chartCanvas.getContext('2d');
            const data = {
                labels: Object.values(styles),
                datasets: [{
                    label: 'é¢¨æ ¼å‚¾å‘',
                    data: Object.values(scores),
                    fill: true,
                    backgroundColor: 'rgba(0, 218, 238, 0.2)', /* ä½¿ç”¨å“ç‰Œè¼”åŠ©è‰², é€æ˜åº¦0.2 */
                    borderColor: '#00daee', /* å“ç‰Œè¼”åŠ©è‰² */
                    pointBackgroundColor: '#00daee',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#00daee',
                    borderWidth: 2,
                    pointRadius: 4
                }]
            };

            if (myChart) {
                myChart.destroy();
            }

            myChart = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: '#e0e0e0' },
                            grid: { color: '#f0f0f0' },
                            suggestedMin: 0,
                            suggestedMax: Math.max(...Object.values(scores), 4),
                            pointLabels: {
                                font: {
                                    size: 14,
                                    family: "'Noto Sans TC', sans-serif",
                                    weight: 'bold'
                                },
                                color: '#004098' /* å“ç‰Œä¸»è‰² */
                            },
                            ticks: { display: false, stepSize: 1 }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function buildAccordion() {
            resultsElements.accordion.innerHTML = '';
            // Sort keys based on scores to show dominant styles first
            const sortedKeys = Object.keys(scores).sort((a,b) => scores[b] - scores[a]);

            sortedKeys.forEach(key => {
                const info = styleInfo[key];
                const score = scores[key];
                const item = document.createElement('div');
                item.className = 'accordion-item';
                // Active first item by default
                const isFirst = key === sortedKeys[0];
                
                item.innerHTML = `
                    <div class="accordion-header">
                        <span>${info.icon} ${info.name} <span style="font-size:0.8em; opacity:0.8; font-weight:400; margin-left:8px;">(å¾—åˆ†: ${score})</span></span>
                    </div>
                    <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p><strong>é¢¨æ ¼æè¿°ï¼š</strong>${info.desc}</p>
                            <p><strong>å„ªå‹¢ï¼š</strong>${info.strength}</p>
                            <p><strong>ç›²é»ï¼š</strong>${info.blindspot}</p>
                            <p><strong>å»ºè­°ï¼š</strong>${info.suggestion}</p>
                        </div>
                    </div>
                `;
                resultsElements.accordion.appendChild(item);
                
                if (isFirst) {
                   item.classList.add('active');
                   // We need to wait for DOM to render to set max-height, handled by listener logic below slightly modified
                }
            });

            // Re-select newly created headers
            const headers = document.querySelectorAll('.accordion-header');
            
            // Set initial height for the first active item
            setTimeout(() => {
                const firstContent = headers[0].nextElementSibling;
                firstContent.style.maxHeight = firstContent.scrollHeight + "px";
            }, 100);

            headers.forEach(header => {
                header.addEventListener('click', () => {
                    const item = header.parentElement;
                    const content = header.nextElementSibling;
                    
                    if (item.classList.contains('active')) {
                        item.classList.remove('active');
                        content.style.maxHeight = null;
                    } else {
                        // Close others
                        document.querySelectorAll('.accordion-item.active').forEach(activeItem => {
                           activeItem.classList.remove('active');
                           activeItem.querySelector('.accordion-content').style.maxHeight = null;
                        });

                        item.classList.add('active');
                        content.style.maxHeight = content.scrollHeight + "px";
                    }
                });
            });
        }
        
        // --- Event Listeners ---
        buttons.start.addEventListener('click', () => {
            switchScreen(screens.welcome, screens.quiz);
            loadQuestion();
        });

        buttons.next.addEventListener('click', () => {
            const selected = document.querySelector('input[name="option"]:checked');
            if (selected) {
                scores[selected.value]++;
                currentQuestionIndex++;
                loadQuestion();
            }
        });
        
        buttons.restart.addEventListener('click', () => {
            currentQuestionIndex = 0;
            scores = { competing: 0, collaborating: 0, compromising: 0, avoiding: 0, accommodating: 0 };
            switchScreen(screens.results, screens.welcome);
        });

        buttons.download.addEventListener('click', () => {
            const content = resultsElements.downloadArea;
            
            // Temporarily style for download
            content.classList.add('downloading'); // Optional class hook
            buttons.download.textContent = 'åœ–ç‰‡ç”¢ç”Ÿä¸­...';
            buttons.download.disabled = true;
            
            // Ensure chart is fully rendered before capture
            setTimeout(() => {
                html2canvas(content, { 
                    scale: 2, // High res
                    useCORS: true,
                    backgroundColor: '#ffffff', // Force white background for the image
                    onclone: (clonedDoc) => {
                        // Make sure the cloned chart is visible
                        const clonedChart = clonedDoc.getElementById('results-chart');
                        if(clonedChart) clonedChart.style.display = 'block';
                    }
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'ç¿»è½‰æ•™è‚²_æˆ‘çš„è¡çªç®¡ç†é¢¨æ ¼åˆ†æ.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                }).catch(err => {
                    console.error("ä¸‹è¼‰å¤±æ•—:", err);
                    alert("åœ–ç‰‡ç”¢ç”Ÿå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
                }).finally(() => {
                    content.classList.remove('downloading');
                    buttons.download.textContent = 'ä¸‹è¼‰æˆ‘çš„é¢¨æ ¼åˆ†æåœ–';
                    buttons.download.disabled = false;
                });
            }, 500);
        });
    });
    </script>
</body>
</html>
